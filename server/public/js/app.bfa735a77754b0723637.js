webpackJsonp([1],{0:function(e,t){},"5Qkr":function(e,t){},"63yX":function(e,t){},E0P5:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("7+uW"),r={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var i=a("VU/8")({name:"App"},r,!1,function(e){a("gMCB")},null,null).exports,s=a("Xxa5"),o=a.n(s),l=a("exGp"),c=a.n(l),u=a("/ocq"),p={render:function(){var e=this.$createElement,t=this._self._c||e;return t("el-row",[t("el-col",[t("router-link",{attrs:{to:"/"}},[t("b",[this._v("KuHe 酷核")])]),this._v(" "),t("span",[this._v("学习编程永远都不晚")])],1)],1)},staticRenderFns:[]},d=a("VU/8")({},p,!1,null,null,null).exports,h={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("span",[this._v("Made with ❤️ by Alex Zhao | kuhe.io ️© 2018")])])}]},m=a("VU/8")({},h,!1,null,null,null).exports,v={components:{MyHeader:d,MyFooter:m},data:function(){return{name:"",pwd:""}},methods:{login:function(){var e=c()(o.a.mark(function e(t,a){var n,r,i,s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={name:t,pwd:a},e.next=4,this.$axios.post("/api/login",n);case 4:r=e.sent,i=r.data,s=i.message,this.showMessage(s,"success"),this.$router.push("/"),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0),this.showMessage(e.t0.toString(),"error");case 15:case"end":return e.stop()}},e,this,[[0,11]])}));return function(t,a){return e.apply(this,arguments)}}(),showMessage:function(e,t){this.$message({message:e,type:t,center:!0,showClose:!0,duration:1500})}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",[a("my-header")],1),e._v(" "),a("el-main",[a("el-card",{staticStyle:{width:"400px",height:"400px",margin:"0 auto"}},[a("h3",[e._v("管理员登陆")]),e._v(" "),a("el-form",{ref:"form"},[a("el-form-item",[a("el-input",{attrs:{placeholder:"请输入管理员账号"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"pass"}},[a("el-input",{attrs:{type:"password",autocomplete:"off",placeholder:"请输入密码"},model:{value:e.pwd,callback:function(t){e.pwd=t},expression:"pwd"}})],1),e._v(" "),a("el-form-item",[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:function(t){e.login(e.name,e.pwd)}}},[e._v("\n            登陆\n          ")])],1)],1)],1)],1),e._v(" "),a("el-footer",[a("my-footer")],1)],1)},staticRenderFns:[]};var g=a("VU/8")(v,f,!1,function(e){a("RMhy")},"data-v-7ba1140f",null).exports,b={methods:{handleLogout:function(e){var t=this;return c()(o.a.mark(function a(){var n,r;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if("logout"!==e){a.next=9;break}return a.next=3,t.$axios.get("/api/logout");case 3:n=a.sent,r=n.data,t.$message.success(r.message),t.$router.push("/login"),a.next=10;break;case 9:t.$router.push("/"+e);case 10:case"end":return a.stop()}},a,t)}))()}}},w={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-menu",{attrs:{"default-active":e.$route.name.toLowerCase(),"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},on:{select:e.handleLogout}},[a("el-menu-item",{attrs:{index:"overview"}},[a("i",{staticClass:"el-icon-view"}),e._v(" "),a("span",[e._v("概览")])]),e._v(" "),a("el-menu-item",{attrs:{index:"list"}},[a("i",{staticClass:"el-icon-tickets"}),e._v(" "),a("span",[e._v("文章管理")])]),e._v(" "),a("el-menu-item",{attrs:{index:"write"}},[a("i",{staticClass:"el-icon-edit"}),e._v(" "),a("span",[e._v("写文章")])]),e._v(" "),a("el-menu-item",{attrs:{index:"categories"}},[a("i",{staticClass:"el-icon-menu"}),e._v(" "),a("span",[e._v("文章分类")])]),e._v(" "),a("el-menu-item",{attrs:{index:"google"}},[e._v("Google Analytics")]),e._v(" "),a("el-menu-item",{attrs:{index:"settings"}},[a("i",{staticClass:"el-icon-setting"}),e._v(" "),a("span",[e._v("全局设置")])]),e._v(" "),a("el-menu-item",{attrs:{index:"logout"}},[e._v("退出登录")])],1)],1)},staticRenderFns:[]},_={components:{MyHeader:d,MyFooter:m,SidePanel:a("VU/8")(b,w,!1,null,null,null).exports}},x={render:function(){var e=this.$createElement,t=this._self._c||e;return t("el-container",[t("el-header",[t("my-header")],1),this._v(" "),t("el-container",[t("el-aside",[t("side-panel")],1),this._v(" "),t("el-main",[t("transition",{attrs:{name:"fade",mode:"out-in"}},[t("router-view")],1)],1)],1),this._v(" "),t("el-footer",[t("my-footer")],1)],1)},staticRenderFns:[]};var k=a("VU/8")(_,x,!1,function(e){a("ikFm")},null,null).exports,y={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("ul",[t("li",[this._v("1.文章总数")]),this._v(" "),t("li",[this._v("2.最新评论")]),this._v(" "),t("li",[this._v("3.")]),this._v(" "),t("li",[this._v("4.")])])])}]},C=a("VU/8")({},y,!1,null,null,null).exports,$={data:function(){return{tableData:[],totalArticleCount:0,currentPage:1,pageSize:10,searchKeyword:""}},created:function(){this.loadPage(this.currentPage,this.pageSize)},methods:{loadPage:function(e,t){var a=this;return c()(o.a.mark(function n(){var r,i,s,l;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,a.$axios.get("/api/articles",{params:{pageNum:e,pageSize:t,isFromAdmin:!0}});case 3:r=n.sent,i=r.data,s=i.articleList,l=i.totalArticleCount,a.tableData=s,a.totalArticleCount=l,n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),a.$message.error(n.t0);case 12:case"end":return n.stop()}},n,a,[[0,9]])}))()},searchForKW:function(){var e=this;return c()(o.a.mark(function t(){var a,n,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.get("/api/search",{params:{keyword:e.searchKeyword}});case 3:a=t.sent,n=a.data,r=n.articles,e.tableData=r,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),e.$message.error(t.t0);case 12:case"end":return t.stop()}},t,e,[[0,9]])}))()},handlePageSizeChange:function(e){this.loadPage(this.currentPage,e),this.pageSize=e},handleCurrentChange:function(e){this.loadPage(e,this.pageSize),this.currentPage=e},handleEdit:function(e,t){this.$router.push({path:"edit/"+t._id})},handleDelete:function(e,t){var a=this;this.$confirm("此操作将永久删除该文章, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(c()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.$axios.delete("/api/articles/"+t._id);case 2:a.loadPage(a.currentPage,a.pageSize),a.$message({type:"success",message:"删除成功!"});case 4:case"end":return e.stop()}},e,a)}))).catch(function(){a.$message({type:"info",message:"已取消删除"})})}}},S={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-row",[a("el-col",{attrs:{span:10}},[a("el-input",{attrs:{placeholder:"搜索酷核"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.searchForKW(t):null}},model:{value:e.searchKeyword,callback:function(t){e.searchKeyword=t},expression:"searchKeyword"}})],1),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchForKW}})],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{width:"180",label:"文章标题",prop:"title"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{attrs:{target:"_blank",href:"http://127.0.0.1:3000/articles/"+t.row._id}},[e._v("\n          "+e._s(t.row.title)+"\n        ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"180",label:"发布日期",prop:"createTime.fullDate"}}),e._v(" "),a("el-table-column",{attrs:{width:"180",label:"分类",prop:"category.cnName"}}),e._v(" "),a("el-table-column",{attrs:{width:"180",label:"是否公开"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.isPublic?"是":"否")+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"180",label:"是否发布"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.isPublished?"是":"否")+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"180",label:"操作",prop:"operation"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.handleEdit(t.$index,t.row)}}},[e._v("\n          编辑\n        ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.handleDelete(t.$index,t.row)}}},[e._v("\n          删除\n        ")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{background:"",total:e.totalArticleCount,"current-page":1,"page-sizes":[10,20],"page-size":10,layout:"prev, pager, next, sizes, total"},on:{"size-change":e.handlePageSizeChange,"current-change":e.handleCurrentChange}})],1)},staticRenderFns:[]},T=a("VU/8")($,S,!1,null,null,null).exports,I=a("//Fk"),P=a.n(I),E=a("d7EF"),D=a.n(E),M=a("woOf"),V=a.n(M),F=a("5x2J"),R=a.n(F),L=a("EFqf"),N=a.n(L),z={name:"markdown-editor",props:{value:String,name:String,previewClass:String,autoinit:{type:Boolean,default:function(){return!0}},highlight:{type:Boolean,default:function(){return!1}},sanitize:{type:Boolean,default:function(){return!1}},configs:{type:Object,default:function(){return{}}}},mounted:function(){this.autoinit&&this.initialize()},activated:function(){var e=this.simplemde;e&&((e.isSideBySideActive()||e.isPreviewActive())&&e.toggleFullScreen())},methods:{initialize:function(){var e=V()({element:this.$el.firstElementChild,initialValue:this.value,renderingConfig:{}},this.configs);e.initialValue&&this.$emit("input",e.initialValue),this.highlight&&(e.renderingConfig.codeSyntaxHighlighting=!0),N.a.setOptions({sanitize:this.sanitize}),this.simplemde=new R.a(e);var t=this.previewClass||"";this.addPreviewClass(t),this.bindingEvents()},bindingEvents:function(){var e=this;this.simplemde.codemirror.on("change",function(){e.$emit("input",e.simplemde.value())})},addPreviewClass:function(e){var t=this.simplemde.codemirror.getWrapperElement(),a=document.createElement("div");t.nextSibling.className+=" "+e,a.className="editor-preview "+e,t.appendChild(a)}},destroyed:function(){this.simplemde=null},watch:{value:function(e){e!==this.simplemde.value()&&this.simplemde.value(e)}}},U={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"markdown-editor"},[t("textarea",{attrs:{name:this.name}})])},staticRenderFns:[]};var A=a("VU/8")(z,U,!1,function(e){a("dRvZ")},null,null).exports,W=a("V8mf"),q=a.n(W);window.hljs=q.a;var O={components:{markdownEditor:A},data:function(){return{article:{coverImage:{}},categoryId:"",categoryList:[],imagePathPrefix:"",totalTagList:[],selectedTags:[],mdeConfigs:{spellChecker:!1,renderingConfig:{codeSyntaxHighlighting:!0}}}},computed:{coverImageSrc:function(){return this.imagePathPrefix+this.article.coverImage.webName}},created:function(){var e=this;return c()(o.a.mark(function t(){var a,n,r,i,s,l,c,u,p;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=e.$route.params.id,n=e.$axios.get("/api/articles/"+a),r=e.$axios.get("/api/categories"),i=e.$axios.get("/api/tags"),t.next=7,P.a.all([n,r,i]);case 7:s=t.sent,l=D()(s,3),c=l[0],u=l[1],p=l[2],e.article=c.data.article,e.imagePathPrefix=c.data.imagePathPrefix,e.categoryId=e.article.category._id,e.categoryList=u.data.result,e.totalTagList=p.data.totalTagList,e.selectedTags=e.article.tags.map(function(e){return e.name}),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(0),e.$message.error(t.t0);case 23:case"end":return t.stop()}},t,e,[[0,20]])}))()},methods:{cancelEdit:function(){this.$router.back()},showMessage:function(e,t){this.$message({message:e,type:t,center:!0,showClose:!0,duration:1500})},navBack:function(){this.$router.back()},showInput:function(){var e=this;this.tagInputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm:function(){var e=this.tagInputValue;e&&this.article.tags.push(e),this.tagInputVisible=!1,this.tagInputValue=""},handleClose:function(e){this.article.tags.splice(this.article.tags.indexOf(e),1)},saveUpdate:function(){var e=this;return c()(o.a.mark(function t(){var a,n,r,i,s,l,c,u,p,d,h,m;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.article.rawContent.trim()){t.next=2;break}return t.abrupt("return",e.showMessage("请输入文章内容","warning"));case 2:if(e.article.category){t.next=4;break}return t.abrupt("return",e.showMessage("请选择文章类别","warning"));case 4:if(a=e.totalTagList.map(function(e){return e.name}),0!==(n=e.selectedTags.filter(function(e){return!a.includes(e)})).length){t.next=10;break}r=e.totalTagList.filter(function(t){return e.selectedTags.includes(t.name)}).map(function(e){return e._id}),t.next=18;break;case 10:return t.next=12,e.$axios.post("/api/tags",{newTagNameList:n});case 12:return t.next=14,e.$axios.get("api/tags");case 14:i=t.sent,s=i.data,l=s.totalTagList,r=l.filter(function(t){return e.selectedTags.includes(t.name)}).map(function(e){return e._id});case 18:return c=e.$refs.markdownEditor.simplemde,u=c.markdown(e.article.rawContent),p={id:e.article._id,rawContent:e.article.rawContent,htmlContent:u,category:e.categoryId,tags:r,isPublic:e.article.isPublic},t.prev=21,t.next=24,e.$axios.patch("/api/articles",p);case 24:d=t.sent,h=d.data,m=h.message,e.showMessage(m,"success"),e.$router.back(),t.next=34;break;case 31:t.prev=31,t.t0=t.catch(21),e.showMessage(t.t0);case 34:case"end":return t.stop()}},t,e,[[21,31]])}))()}}},B={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-button",{on:{click:e.navBack}},[e._v("后退")]),e._v(" "),a("el-row",[a("el-input",{attrs:{value:e.article.title,placeholder:"请在这里输入标题",disabled:""}})],1),e._v(" "),a("el-row",[a("el-input",{attrs:{value:"author",placeholder:"请输入作者",disabled:""}})],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("span",[e._v("标签：")]),e._v(" "),a("el-select",{ref:"myselect",attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择文章标签","multiple-limit":3},model:{value:e.selectedTags,callback:function(t){e.selectedTags=t},expression:"selectedTags"}},e._l(e.totalTagList,function(e){return a("el-option",{key:e._id,attrs:{value:e.name}})}),1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("span",[e._v("分类：")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择文章类别"},model:{value:e.categoryId,callback:function(t){e.categoryId=t},expression:"categoryId"}},e._l(e.categoryList,function(e){return a("el-option",{key:e.enName,attrs:{label:e.cnName,value:e._id}})}),1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("span",[e._v("原创声明：")]),e._v(" "),a("el-select",{attrs:{placeholder:"请声明原创",disabled:""},model:{value:e.article.isOriginal,callback:function(t){e.$set(e.article,"isOriginal",t)},expression:"article.isOriginal"}},[a("el-option",{attrs:{label:"原创",value:!0}}),e._v(" "),a("el-option",{attrs:{label:"转载",value:!1}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("span",[e._v("是否公开：")]),e._v(" "),a("el-select",{attrs:{placeholder:"请设置"},model:{value:e.article.isPublic,callback:function(t){e.$set(e.article,"isPublic",t)},expression:"article.isPublic"}},[a("el-option",{attrs:{label:"公开",value:!0}}),e._v(" "),a("el-option",{attrs:{label:"私有",value:!1}})],1)],1)],1),e._v(" "),a("markdown-editor",{ref:"markdownEditor",staticClass:"theme",staticStyle:{"text-align":"justify"},attrs:{configs:e.mdeConfigs,highlight:!0,"preview-class":"markdown-body"},model:{value:e.article.rawContent,callback:function(t){e.$set(e.article,"rawContent",t)},expression:"article.rawContent"}}),e._v(" "),a("h4",[e._v("封面和摘要")]),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("img",{attrs:{src:e.coverImageSrc,alt:"封面图片"}})]),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{value:e.article.description,type:"textarea",rows:3,placeholder:"选填，如果不填写会默认抓取正文前的54个字",resize:"none",disabled:""}})],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-button",{attrs:{size:"small",plain:""},on:{click:e.cancelEdit}},[e._v("\n        取消\n      ")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.saveUpdate}},[e._v("\n        保存\n      ")])],1)],1)],1)},staticRenderFns:[]};var K=a("VU/8")(O,B,!1,function(e){a("E0P5")},null,null).exports,H=a("sRoY"),j={components:{VueCropper:a.n(H).a},props:{isDialogShow:{type:Boolean,required:!0}},data:function(){return{activeStep:0,dialogVisible:!1,urlSourceImg:"",canvasCroppedImgWeb:null,canvasCroppedImgMobile:null,isCropForWeb:!0,webRatio:1,mobileRatio:2.35,selectedFileName:""}},computed:{urlCroppedImgWeb:function(){return this.canvasCroppedImgWeb?this.canvasCroppedImgWeb.toDataURL():""},urlCroppedImgMobile:function(){return this.canvasCroppedImgMobile?this.canvasCroppedImgMobile.toDataURL():""}},watch:{isDialogShow:function(e,t){this.dialogVisible=e}},methods:{handleSuccessUpload:function(e,t,a){var n=this;return c()(o.a.mark(function t(){var a,r,i,s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.selectedFileName=e.fileName,console.log(e.url),t.next=4,n.$axios.get(e.url,{responseType:"blob"});case 4:a=t.sent,r=a.data,i=new FileReader,i.readAsDataURL(r),s=n,i.onload=function(){s.urlSourceImg=this.result};case 10:case"end":return t.stop()}},t,n)}))()},handleDialogClose:function(){this.dialogVisible=!1,this.$emit("close",this.dialogVisible),this.activeStep=0,this.urlSourceImg="",this.canvasCroppedImgWeb=null,this.canvasCroppedImgMobile=null},nextStep:function(){this.activeStep>=1||this.activeStep++},lastStep:function(){this.activeStep=0},getBlob:function(e){return new P.a(function(t,a){e.toBlob(function(e){return t(e)})})},finishCoverSetting:function(){var e=this;return c()(o.a.mark(function t(){var a,n,r,i,s,l;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getBlob(e.canvasCroppedImgWeb);case 2:return a=t.sent,t.next=5,e.getBlob(e.canvasCroppedImgMobile);case 5:return n=t.sent,r=new FormData,t.next=9,r.append("web",a,e.selectedFileName);case 9:return r.append("mobile",n,e.selectedFileName),i={header:{"Content-Type":"multipart/form-data"},timeout:3e4},t.next=13,e.$axios.patch("/api/upload/images",r,i);case 13:s=t.sent,l=s.data,e.$emit("success",l),e.handleDialogClose(),e.$message.success("封面设置成功");case 18:case"end":return t.stop()}},t,e)}))()},setCropperAspectRatio:function(e){this.isCropForWeb=e===this.webRatio,this.$refs.cropper.setAspectRatio(e)},handleCrop:function(){this.isCropForWeb?this.canvasCroppedImgWeb=this.$refs.cropper.getCroppedCanvas({width:260,height:260,imageSmoothingEnabled:!0}):this.canvasCroppedImgMobile=this.$refs.cropper.getCroppedCanvas({width:900,height:383,imageSmoothingEnabled:!0,imageSmoothingQuality:"high"})}}},G={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.dialogVisible,"before-close":e.handleDialogClose,width:"80%",height:"800"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{attrs:{slot:"title"},slot:"title"},[a("h4",[e._v("选择图片")]),e._v(" "),a("el-steps",{attrs:{active:e.activeStep,"align-center":"","process-status":"finish","finish-status":"wait"}},[a("el-step",{attrs:{title:"从素材库选择封面"}}),e._v(" "),a("el-step",{attrs:{title:"剪切封面"}})],1)],1),e._v(" "),a("div",[a("el-row",[e.activeStep<1?a("section",[a("el-col",{attrs:{span:6}},[a("el-menu",{attrs:{"default-active":"0"}},[a("el-menu-item",{attrs:{index:"0"}},[e._v("全部图片(53)")]),e._v(" "),a("el-menu-item",{attrs:{index:"1"}},[e._v("未分组(8)")]),e._v(" "),a("el-menu-item",{attrs:{index:"2"}},[e._v("文章配图(45)")]),e._v(" "),a("el-menu-item",{attrs:{index:"3"}},[e._v("＋新建分组")])],1)],1),e._v(" "),a("el-col",{attrs:{span:18}},[a("el-row",[a("el-upload",{attrs:{action:"/api/upload/images/","with-credentials":!0,"on-success":e.handleSuccessUpload}},[a("el-button",{attrs:{type:"primary",size:"small"}},[e._v("本地上传")])],1)],1),e._v(" "),a("br"),e._v(" "),a("el-row",[e._v("img list")])],1)],1):a("section",[a("el-row",[a("el-col",{attrs:{span:10}},[a("p",[a("b",[e._v("剪裁封面")])]),e._v(" "),a("div",{staticStyle:{width:"300px",height:"300px",border:"1px solid gray",display:"inline-block"}},[a("vue-cropper",{ref:"cropper",attrs:{src:e.urlSourceImg,alt:"Image to be cropped","drag-mode":"crop","auto-crop-area":.5,"min-container-width":200,"min-container-height":180,"aspect-ratio":1,movable:!1,zoomable:!1,background:!0,"img-style":{width:"300px",height:"300px"}},nativeOn:{crop:function(t){return e.handleCrop(t)}}})],1),e._v(" "),a("p",[e._v("可选择一个尺寸的封面单独剪裁")]),e._v(" "),a("el-button",{attrs:{autofocus:!1,type:"text"},on:{click:function(t){e.setCropperAspectRatio(e.webRatio)}}},[e._v("1:1")]),e._v(" "),a("el-button",{attrs:{autofocus:!1,type:"text"},on:{click:function(t){e.setCropperAspectRatio(e.mobileRatio)}}},[e._v("2.35:1")])],1),e._v(" "),a("el-col",{attrs:{span:14}},[a("p",[a("b",[e._v("预览封面")])]),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6}},[a("img",{staticStyle:{width:"130px",height:"130px",border:"1px solid gray"},attrs:{src:e.urlCroppedImgWeb,alt:"Cropped Image"}})]),e._v(" "),a("el-col",{attrs:{span:18}},[a("p",[a("b",[e._v("web端封面 (1:1)")])]),e._v(" "),a("p",[e._v("通过web端浏览文章页面（卡片视图）的用户，将看到此封面。")])])],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6}},[a("img",{staticStyle:{width:"130px",height:"56px",border:"1px solid gray"},attrs:{src:e.urlCroppedImgMobile,alt:"Cropped Image"}})]),e._v(" "),a("el-col",{attrs:{span:18}},[a("span",[a("b",[e._v("移动端封面 (2.35:1)")])]),e._v(" "),a("p",[e._v("通过移动端浏览文章页面（卡片视图）的用户，将看到此封面。")])])],1)],1)],1)],1)])],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[e.activeStep<1?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.nextStep}},[e._v("下一步")]):a("div",[a("el-button",{attrs:{size:"small"},on:{click:e.lastStep}},[e._v("上一步")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.finishCoverSetting}},[e._v("完成")])],1)],1)])},staticRenderFns:[]},X=a("VU/8")(j,G,!1,null,null,null).exports;window.hljs=q.a;var Z={components:{MarkdownEditor:A,MyDialog:X},data:function(){return{title:"",author:"",rawContent:"",description:"",tagInputVisible:!1,tagInputValue:"",selectData:[],category:"",isOriginal:!0,isPublic:!0,checked:!1,datePickerValue:"",totalTagList:[],selectedTags:[],imageUrl:"",imageId:"",isDialogShow:!1,mdeConfigs:{spellChecker:!1,placeholder:"从这里开始写正文",renderingConfig:{codeSyntaxHighlighting:!0}}}},created:function(){var e=this;return c()(o.a.mark(function t(){var a,n,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.get("/api/categories");case 3:return a=t.sent,n=a.data,e.selectData=n.result,t.next=8,e.$axios.get("/api/tags");case 8:r=t.sent,e.totalTagList=r.data.totalTagList,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),e.$message.error(t.t0);case 15:case"end":return t.stop()}},t,e,[[0,12]])}))()},methods:{showMessage:function(e,t){this.$message({message:e,type:t,center:!0,showClose:!0,duration:1500})},handleDialogSuccess:function(e){this.imageUrl=e.imagePathPrefix+e.imageDoc.webName,this.imageId=e.imageDoc._id},publish:function(e){var t=this;return c()(o.a.mark(function a(){var n,r,i,s,l,c,u,p,d,h,m,v;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t.title.trim()){a.next=2;break}return a.abrupt("return",t.showMessage("请输入文章标题","warning"));case 2:if(t.author.trim()){a.next=4;break}return a.abrupt("return",t.showMessage("请输入文章作者","warning"));case 4:if(t.rawContent.trim()){a.next=6;break}return a.abrupt("return",t.showMessage("请输入文章内容","warning"));case 6:if(t.category){a.next=8;break}return a.abrupt("return",t.showMessage("请选择文章类别","warning"));case 8:if(!(t.description.length>54)){a.next=10;break}return a.abrupt("return",t.showMessage("文章摘要过长","warning"));case 10:if(t.imageId){a.next=12;break}return a.abrupt("return",t.showMessage("请选择封面图片","warning"));case 12:if(t.description.trim()||(t.description=t.rawContent.slice(0,54)+"..."),n=t.totalTagList.map(function(e){return e.name}),0!==(r=t.selectedTags.filter(function(e){return!n.includes(e)})).length){a.next=19;break}i=t.totalTagList.filter(function(e){return t.selectedTags.includes(e.name)}).map(function(e){return e._id}),a.next=27;break;case 19:return a.next=21,t.$axios.post("/api/tags",{newTagNameList:r});case 21:return a.next=23,t.$axios.get("api/tags");case 23:s=a.sent,l=s.data,c=l.totalTagList,i=c.filter(function(e){return t.selectedTags.includes(e.name)}).map(function(e){return e._id});case 27:return u=t.$refs.markdownEditor.simplemde,p=u.markdown(t.rawContent),d={title:t.title,author:t.author,description:t.description,rawContent:t.rawContent,htmlContent:p,category:t.category,tags:i,coverImage:t.imageId,isPublic:t.isPublic,isPublished:e,isOriginal:t.isOriginal,createTime:t.datePickerValue},a.prev=30,a.next=33,t.$axios.post("/api/articles",d);case 33:h=a.sent,m=h.data,v=m.message,t.showMessage(v,"success"),t.$router.push({name:"Index"}),t.newTagList=[],a.next=44;break;case 41:a.prev=41,a.t0=a.catch(30),t.showMessage(a.t0);case 44:case"end":return a.stop()}},a,t,[[30,41]])}))()}}},J={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-row",[a("el-input",{attrs:{placeholder:"请在这里输入标题"},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}})],1),e._v(" "),a("el-row",[a("el-input",{attrs:{placeholder:"请输入作者"},model:{value:e.author,callback:function(t){e.author=t},expression:"author"}})],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("span",[e._v("标签：")]),e._v(" "),a("el-select",{ref:"myselect",attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择文章标签","multiple-limit":3},model:{value:e.selectedTags,callback:function(t){e.selectedTags=t},expression:"selectedTags"}},e._l(e.totalTagList,function(e){return a("el-option",{key:e._id,attrs:{value:e.name}})}),1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("span",[e._v("分类：")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择文章类别"},model:{value:e.category,callback:function(t){e.category=t},expression:"category"}},e._l(e.selectData,function(e){return a("el-option",{key:e.enName,attrs:{label:e.cnName,value:e._id}})}),1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("span",[e._v("原创声明：")]),e._v(" "),a("el-select",{attrs:{placeholder:"请声明原创"},model:{value:e.isOriginal,callback:function(t){e.isOriginal=t},expression:"isOriginal"}},[a("el-option",{attrs:{label:"原创",value:!0}}),e._v(" "),a("el-option",{attrs:{label:"转载",value:!1}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("span",[e._v("是否公开：")]),e._v(" "),a("el-select",{attrs:{placeholder:"请设置"},model:{value:e.isPublic,callback:function(t){e.isPublic=t},expression:"isPublic"}},[a("el-option",{attrs:{label:"公开",value:!0}}),e._v(" "),a("el-option",{attrs:{label:"私有",value:!1}})],1)],1)],1),e._v(" "),a("markdown-editor",{ref:"markdownEditor",staticClass:"theme",staticStyle:{"text-align":"justify"},attrs:{configs:e.mdeConfigs,highlight:!0,"preview-class":"markdown-body"},model:{value:e.rawContent,callback:function(t){e.rawContent=t},expression:"rawContent"}}),e._v(" "),a("h4",[e._v("封面和摘要")]),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-button",{attrs:{type:"text"},on:{click:function(t){e.isDialogShow=!0}}},[e.imageUrl?a("img",{attrs:{src:e.imageUrl,alt:"titleImage"}}):a("i",{staticClass:"el-icon-plus"},[a("p",[e._v("选择封面")])])])],1),e._v(" "),a("my-dialog",{attrs:{"is-dialog-show":e.isDialogShow},on:{close:function(t){e.isDialogShow=!1},success:e.handleDialogSuccess}}),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:"选填，如果不填写会默认抓取正文前的54个字",resize:"none"},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}})],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-checkbox",{model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("是旧文章，设置发表时间？")])],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-date-picker",{directives:[{name:"show",rawName:"v-show",value:e.checked,expression:"checked"}],attrs:{type:"datetime",placeholder:"设置发表时间","default-time":"12:00:00"},model:{value:e.datePickerValue,callback:function(t){e.datePickerValue=t},expression:"datePickerValue"}})],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){e.publish(!1)}}},[e._v("\n        保存\n      ")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){e.publish(!0)}}},[e._v("\n        发表\n      ")])],1)],1)],1)},staticRenderFns:[]};var Q=a("VU/8")(Z,J,!1,function(e){a("63yX")},null,null).exports,Y={data:function(){return{tableData:[],isDialogShow:!1,dialogTitle:"",requestUrl:"",isGET:null,formLabelWidth:"70px",form:{enName:"",cnName:"",description:""}}},created:function(){var e=this;return c()(o.a.mark(function t(){var a,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.get("/api/categories");case 3:a=t.sent,n=a.data,e.tableData=n.result,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),e.$message.error(t.t0);case 11:case"end":return t.stop()}},t,e,[[0,8]])}))()},methods:{handleConfirm:function(){var e=this;return c()(o.a.mark(function t(){var a,n,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,console.log(e.requestUrl),!e.isGET){t.next=8;break}return t.next=5,e.$axios.post(e.requestUrl,e.form);case 5:t.t0=t.sent,t.next=11;break;case 8:return t.next=10,e.$axios.patch(e.requestUrl,e.form);case 10:t.t0=t.sent;case 11:a=t.t0,n=a.data,r=n.message,e.$message.success(r),window.setTimeout(function(){window.location.reload()},1e3),t.next=21;break;case 18:t.prev=18,t.t1=t.catch(0),e.$message.error(t.t1.toString());case 21:e.form={},e.isDialogShow=!1;case 23:case"end":return t.stop()}},t,e,[[0,18]])}))()},handleCancel:function(){this.form={},this.isDialogShow=!1},handleAdd:function(){this.dialogTitle="增加文章分类",this.isDialogShow=!0,this.requestUrl="/api/categories",this.isGET=!0},handleEdit:function(e){this.dialogTitle="修改文章分类";var t=e.cnName,a=e.enName,n=e.description;this.form={cnName:t,enName:a,description:n},this.isDialogShow=!0,this.requestUrl="/api/categories/"+e._id,this.isGET=!1},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除该分类, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(c()(o.a.mark(function a(){return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$axios.delete("/api/categories/"+e._id);case 2:t.$message({type:"success",message:"删除成功!"}),window.setTimeout(function(){window.location.reload()},1e3);case 4:case"end":return a.stop()}},a,t)}))).catch(function(){t.$message({type:"info",message:"已取消删除"})})}}},ee={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{prop:"cnName",label:"分类名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"enName",label:"分类名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"description",label:"说明"}}),e._v(" "),a("el-table-column",{attrs:{prop:"operation"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:e.handleAdd}},[e._v("\n          + 增加分类\n        ")])]}},{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.handleEdit(t.row)}}},[e._v("\n          编辑\n        ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.handleDelete(t.row)}}},[e._v("\n          删除\n        ")])]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.isDialogShow,center:""},on:{"update:visible":function(t){e.isDialogShow=t}}},[a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"中文名称","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off",autofocus:"true",placeholder:"请输入中文"},model:{value:e.form.cnName,callback:function(t){e.$set(e.form,"cnName",t)},expression:"form.cnName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"英文名称","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入英文，空格用“-”代替"},model:{value:e.form.enName,callback:function(t){e.$set(e.form,"enName",t)},expression:"form.enName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"说明","label-width":e.formLabelWidth}},[a("el-input",{attrs:{type:"textarea",rows:3,resize:"none",autocomplete:"off",placeholder:"请输入内容"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)],1),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("\n        确定\n      ")])],1)],1)],1)},staticRenderFns:[]},te=a("VU/8")(Y,ee,!1,null,null,null).exports,ae={render:function(){var e=this.$createElement;return(this._self._c||e)("div",[this._v("123")])},staticRenderFns:[]},ne=a("VU/8")({},ae,!1,null,null,null).exports,re={render:function(){var e=this.$createElement;return(this._self._c||e)("div",[this._v("123")])},staticRenderFns:[]},ie=a("VU/8")({},re,!1,null,null,null).exports,se=a("mtWM"),oe=a.n(se);oe.a.defaults.baseURL="http://66.42.37.118",oe.a.defaults.withCredentials=!0,oe.a.interceptors.response.use(function(e){return e},function(e){return e.response&&(403!==e.response.status&&400!==e.response.status||we.$router.replace({path:"/login"})),P.a.reject(e.response.data.error)});var le=oe.a,ce=function(){return le.get("/api/login").then(function(){return!0}).catch(function(e){return we.$message.error(e),!1})},ue=this;n.default.use(u.a);var pe,de=[{path:"/login",name:"Login",component:g},{path:"/",name:"Index",component:k,redirect:"/overview",meta:{requireAuth:!0},children:[{path:"overview",name:"Overview",component:C,meta:{requireAuth:!0}},{path:"list",name:"List",component:T,meta:{requireAuth:!0}},{path:"edit/:id",name:"Edit",component:K,meta:{requireAuth:!0}},{path:"write",name:"Write",component:Q,meta:{requireAuth:!0}},{path:"categories",name:"Categories",component:te,meta:{requireAuth:!0}},{path:"google",name:"Google",component:ne,meta:{requireAuth:!0}},{path:"settings",name:"Settings",component:ie,meta:{requireAuth:!0}}]}],he=new u.a({mode:"history",routes:de});he.beforeEach((pe=c()(o.a.mark(function e(t,a,n){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.matched.some(function(e){return e.meta.requireAuth})){e.next=6;break}return e.next=3,ce();case 3:e.sent||n({path:"/login"}),n();case 6:n();case 7:case"end":return e.stop()}},e,ue)})),function(e,t,a){return pe.apply(this,arguments)}));var me=he,ve=a("NYxO");n.default.use(ve.a);var fe=new ve.a.Store({state:function(){return{artcles:[]}},mutations:{}}),ge=a("zL8q"),be=a.n(ge);a("tvR6");n.default.use(be.a),n.default.prototype.$axios=le,n.default.config.productionTip=!1;var we=t.default=new n.default({el:"#app",router:me,components:{App:i},template:"<App/>",store:fe})},RMhy:function(e,t){},dRvZ:function(e,t){},gMCB:function(e,t){},ikFm:function(e,t){},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.bfa735a77754b0723637.js.map